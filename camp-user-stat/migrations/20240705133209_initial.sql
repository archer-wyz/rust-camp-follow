-- Add migration script here
CREATE TYPE gender AS ENUM(
  'female',
  'male',
  'unknown'
);

-- INSERT INTO user_stats(email, name, gender, created_at, last_visited_at, last_watched_at, recent_watched, viewed_but_not_started, started_but_not_finished, finished, last_email_notification, last_in_app_notification, last_sms_notification)
  -- VALUES ('adolph.02ts3f95@example.org', '贾紫芳', 'unknown', '2024-01-01 00:00:14.641548-08', '2024-04-29 19:07:14.641548-07', '2024-03-24 04:58:14.641548-07', '{128888,167569,102464,173548,119340,142615,172772,126920,108288,122816,104831,109677,135126,161001,144887,192683,156251,113393,133734,121914,191362,142882,128601,144073,167123,167520,159611,122138,109946,106058,104438,158113,155732,121820,168752,170090,161640,197226,188182,137774,143797,160451,148269,199508,162225}', '{201148,296436,211614,214337,201939,254140,277791,277305,291164,230882,285544,209517,269463,291211,203712,204522,213237,206191,218790,231501}', '{307917,376812,362200,314149,395800,304535,374662,305470,392878,343619,389799}', '{488449,484464,446386,468524,453695,476374,441716,481013,480226,428477,403904,400670,455364,480333,419933,425483,415440,434367,427097,499172,474755,430613,406484,419226,402572,433756,482107,445488}', '2024-03-21 19:26:14.64155-07', '2024-04-22 05:22:14.64155-07', '2024-04-12 10:02:14.64155-07');

CREATE TABLE IF NOT EXISTS user_stats (
  email VARCHAR(128) NOT NULL PRIMARY KEY,
  name VARCHAR(64) NOT NULL,
  gender gender DEFAULT 'unknown',
  viewed_but_not_started int[],
  recent_watched int[],
  started_but_not_finished int[],
  finished int[],
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  last_visited_at TIMESTAMP,
  last_watched_at TIMESTAMP,
  last_email_notification TIMESTAMP,
  last_in_app_notification TIMESTAMP,
  last_sms_notification TIMESTAMP
);
